name: git-policies
enable: true
modules:
- name: coding-permissions
  type: verify-artifact
  enable: true
  input:
    signed: true
    identity:
      common-names:
        - EvidencePolicyResults4
    context-group:
      - flags
    format: "attest-cyclonedx-json"
    match:
      target_type: git
    rego:
      args:
        ids:
          - "@golang.com"
          - "@golang.org"
          # - '{{.Args.EMAIL}}'
        files:
          - "a.txt"
          # - "jenkins_k8s/scripts/kaniko_config.sh"
      path: coding-permissions.rego

