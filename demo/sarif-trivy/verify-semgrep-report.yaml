# name: verify-semgrep-report
enable: true
modules:
- name: verify-semgrep-report
  type: verify-artifact
  enable: true
  input:
    signed: false
    format: statement-generic
    context-group:
      - flags
    match:
      target_type: generic
      predicate_type: https://aquasecurity.github.io/trivy/v0.42/docs/configuration/reporting/#sarif
    rego:
      args:
        rule_ids:
          - "use-after-free"
        violations_threshold: 2
      path: ../../policies/sarif/verify-semgrep-report.rego
