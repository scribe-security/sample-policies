# name: sarif-policy
enable: true
modules:
- name: sarif-policy
  type: verify-artifact
  enable: true
  input:
    signed: false
    format: statement-generic
    match:
      target_type: generic
      predicate_type: https://aquasecurity.github.io/trivy/v0.42/docs/configuration/reporting/#sarif
    rego:
      args:
        rule_level:
          - error
          # - '{{ .Args.Error }}'
          # - '{{ .Args.Warning }}'
          # - '{{ .Args.Note }}'
          # - '{{ .Args.None }}'
        precision: []
        rule_ids: #'{{block `list` .}}{{`[`}}{{printf `%v` .}}{{`]`}}{{end}}'
          - CVE-2021-3156
          # - '{{ .Args.CVE_1 }}'
          # - '{{ .Args.CVE_2 }}'
          # - '{{ .Args.CVE_3 }}'
          # - '{{ .Args.CVE_4 }}'
          # - '{{block `list` .}}{{range .}}{{.}}{{end}}{{end}}'
          # - '{{define `list`}} {{join . `, `}}{{end}}'
        ignore: []
        max_allowed: 1
      path: ../../policies/sarif/verify-sarif.rego
